# 추가 주제

## 웹 컴포넌트

### 궤도의 높이에서

컴포넌트가 갖춰야 할 것은

- 고유한 자바스크립트 클래스
- 외부코드가 접근할 수 없으며 해당 클래스에서만 관리되는 DOM 구조('캡슐화' 원칙)
- 구성요소에 적용되는 CSS 스타일
- 다른 구성요소와 상호작용하기 위한 이벤트, 클래스, 메서드 등을 일컫는 API
- [Custom elements](https://html.spec.whatwg.org/multipage/custom-elements.html#custom-elements) : 사용자 정의 HTML 요소를 정의
- [Shadow DOM](https://dom.spec.whatwg.org/#shadow-trees) : 다른 컴포넌트에 대해 숨겨져 있는 내부 DOM
- [CSS Scoping](https://drafts.csswg.org/css-scoping/) : 컴포넌트의 Shadow DOM 내부에만 적용되는 스타일을 선언
- [Event retargeting](https://dom.spec.whatwg.org/#retarget)과 사용자 정의 컴포넌트를 개발 환경에 더욱 적합하게 만드는 사소한 것들...

### Custom elements

두 가지 Custom elements

1. Autonomous custom elements : 모든 것이 새로 정의된 요소, `HTMLElement` 클래스
2. Customized built-in elements : 기존 요소를 확장한 요소, 'HTMLButtonElement` 클래스 활용 등

```javascript
class MyElement extends HTMLElement {
  constructor() {
    super()
    // element created
  }

  connectedCallback() {
    // when element is added to the document (added/removed)
  }

  disconnectedCallback() {
    // when element is removed from the document (added/removed)
  }

  static get observedAttributes() {
    return [/* array of attribute names to monitor for changes */]
  }

  attributeChangeCallback(name, oldValue, newValue) {
    // when one of attributes listed above is mofidied
  }

  adoptedCallback() {
    // when the element is moved to a new document
  }

  // other element methods and properties
}

// custom element name must contain a hyphen '-'
customElements.define('my-element', MyElement)
```

### Shadow DOM

Shadow DOM 은 캡슐화 되어 온전히 자신의 DOM 트리를 구성
- 일반적인 Javascript, selectors 로 Shadow DOM 참조 불가

```html
<input type="range">
  #shadow-root (Shadow DOM Tree)
    <div>
      <div pseudo="-webkit-slider-runnable-track"></div>
    </div>
</input>

<style>
input::-webkit-slider-runnable-track {/* */}
</style>
```

DOM 요소는 두 가지 DOM 하위 트리로 구성 가능

- 일반 DOM 트리
- Shadow DOM 트리

```html
<script>
  customElements.define('mingoos-hello', class extends HTMLElement {
    connectedCallback() {
      const shadow = this.attatchShadow({ mode: 'open' /* closed */ })
      shadow.innerHTML = `<div pseudo="-mingoos-el"></div>`
    }
  })
</script>
```

### Template element

내장 요소인 `<template>` 은 콘텐츠에 상관없이 HTML 적합성만 확인

```html
<table>
  <tbody>
    <template>
      <tr><td></td></tr>
    </template>
    <tr><td></td></tr>
  </tbody>
</table>

<template id="template">
  <div><p>MESSAGE</p></div>
</template>

<script>
  const el = document.createElement('div')

  /**
   * <div>
   *   <div><p>MESSAGE</p></div> → template.content.cloneNode(true)
   * </div>
   */
  el.append(template.content.cloneNode(true))
</script>
```
